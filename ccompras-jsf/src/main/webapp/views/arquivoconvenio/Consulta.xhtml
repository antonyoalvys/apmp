<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "DTD/xhtml1-strict.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml" xmlns:h="http://java.sun.com/jsf/html" xmlns:ui="http://java.sun.com/jsf/facelets" xmlns:f="http://java.sun.com/jsf/core"
	xmlns:p="http://primefaces.org/ui" xmlns:o="http://omnifaces.org/ui" xmlns:pe="http://primefaces.org/ui/extensions" template="/views/index.xhtml">

	<ui:define name="content">
		<h:form id="searchForm">
			<f:validateBean disabled="true">
				<p:panel header="Dados da Consulta" style="text-align:center;">
					<div class="ui-g">
	
						<p:outputLabel value="Período" styleClass="ui-g-2" />
						<div class="ui-g-4">
							<p:autoComplete value="#{fileAgreementSearchBean.period}" id="period" dropdown="true" completeMethod="#{fileAgreementSearchBean.autocompletePeriod}" var="var"
								itemLabel="#{var.description}" itemValue="#{var}" minQueryLength="" scrollHeight="200" size="40">
								<o:converter converterId="omnifaces.ListConverter" list="#{fileAgreementSearchBean.periods}" />
							</p:autoComplete>
						</div>
					</div>
					<p:spacer />
					<div class="buttons">
						<p:commandButton id="searchBtn" action="#{fileAgreementSearchBean.findFiles()}" value="Consultar" styleClass="span2" process="@form" update="@form">
							<p:blockUI block="resultsDataTable" trigger="searchBtn">
			                            #{wds['blockui.processing.txt']}<br />
								<h:graphicImage library="images" name="#{wds['blockui.loading.img']}" />
							</p:blockUI>
						</p:commandButton>
	
					</div>
					<p:spacer />
					<p:dataTable id="resultsDataTable" value="#{fileAgreementSearchBean.fileAgreements}" emptyMessage="Nenhum arquivo gerado." var="file">
						<f:facet name="header">Arquivos Gerados</f:facet>
	
						<p:column headerText="Opções">
							<p:commandButton id="deleteCommandButton" icon="ui-icon-trash" title="#{wds['table.columns.options.delete.hint']}" oncomplete="PF('confirmation').show();">
								<f:setPropertyActionListener target="#{fileAgreementSearchBean.deleteFile}" value="#{file}" />
							</p:commandButton>
						</p:column>
						<p:column headerText="Periodo">
							<h:outputText value="#{file.period.description}" />
						</p:column>
						<p:column headerText="Arquivo">
<!-- 							<p:fileDownload value="#{file.file}" /> -->
						</p:column>
					</p:dataTable>

				</p:panel>
			</f:validateBean>

			<p:confirmDialog id="deleteConfirmDialog" message="#{wds['dialog.deleteConfirmation.message']}" header="#{wds['dialog.deleteConfirmation.header']}" widgetVar="confirmation" appendTo="@(body)">
				<p:commandButton id="yesCommandButton" icon="ui-icon-check" value="#{wds['dialog.optionYes']}" onclick="PF('confirmation').hide();" actionListener="#{fileAgreementSearchBean.delete()}" update="@form"
					process="@this" />
				<p:commandButton id="noCommandButton" onclick="PF('confirmation').hide();" icon="ui-icon-cancel" value="#{wds['dialog.optionNo']}" type="button" />
			</p:confirmDialog>

		</h:form>
	</ui:define>

</ui:composition>
